<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta name="keywords" content="JS, JavaScript, data binding, library, framework" />
<meta name="google-site-verification" content="BL0vfzW3EHPzinjTwJNGN9GF9uB9trBo8dTY338fkR4" />
<meta content="img/logo2.png" property="vk:image" />
<title>Autosync</title>
<link rel="stylesheet" href="highlightjs/styles/codepen-embed.min.css">
<script src="highlightjs/highlight.min.js"></script>
<script type="text/javascript" src="autosync.js"></script>
<style type="text/css">

body {
   font-family: Arial;
   font-size: 17px;
   line-height: 160%;
   margin: 0;
}
a {
   color: #309fc9;
}
a: visited {
   color: #69bddd;
}
p {
   margin: 1.5em 0;
   max-width: 95%;
}
#navbar {
   min-height: 50px;
   background: #252c2f;
   box-shadow: 0px 1px 0px 0px rgba(0, 0, 0, 0.2);
   padding: 0px 8px;
   color: #e5e5e5;
}
#navbar > .logo {
   width: 48px;
   height: 48px;
   background: url("img/logo_dark_small.png") center center no-repeat;
   background-size: contain;
}
#navbar > * {
   display: table-cell;
   vertical-align: top;
   min-height: 48px;
}
.nav_items {
   position: absolute;
   top: 0;
   right: 25px;
   width: 360px;
   text-align: right;
}
.nav_items > * {
   display: inline-block;
   vertical-align: top;
   height: 30px;
   padding: 10px 12px;
   overflow: hidden;
   position: relative;
   text-align: left;
   cursor: pointer;
   line-height: 29px;
}
.nav_items > * > .list {
   position: absolute;
   top: 50px;
   right: 0px;
   background: #252d30;
   min-width: 160px;
   border-top: 1px solid #43464a;
   margin-top: -1.5px;
   border-radius: 0px 0px 3px 3px;
}
.list > * {
   padding: 3px 10px;
   font-size: 0.9em;
   cursor: pointer;
}
.nav_items > *:hover {
   overflow: visible;
}
.nav_items > *:hover, .nav_items .list > *:hover {
   background: rgba(120, 120, 120, 0.3);
}
.nav_items a {
   color: #e2e2e2;
   text-decoration: none;
   display: block;
}
#navbar > .title {
   color: #fff;
   text-decoration: none;
   font-size: 24px;
   font-weight: bold;
   line-height: 28px;
   margin-left: 12px;
   vertical-align: middle;
}
@media (max-width: 380px) {
   .nav_items {
      position: absolute;
      top: 0;
      right: 0px;
      width: 160px;
   }
   .nav_items > div:first-child {
      display: none;
   }
   #navbar > .title {
      font-size: 22px;
      font-weight: normal;
      line-height: 26px;
   }
   .list > * {
      padding: 7px 13px;
      font-size: 1em;
   }
}


#container {
   margin: 0px auto;
   max-width: 1000px;
}

section {
   margin-bottom: 38px;
}
section > header {
   font-family: "PT Serif Caption";
   font-weight: bold;
   font-size: 1.8em;
}
#top > content > img {
   margin-left: -20px;
}
.main_title {
   font-size: 50px;
   line-height: 54px;
}
@media (max-width: 480px) {
   #top > content > img {
      margin-left: -35px !important;
      width: auto;
      margin-left: -45px;
      max-height: 140px;
      display: block;
   }
   .main_title {
      font-size: 34px;
      line-height: 38px;
   }
}
@media (max-width: 480px) {
   .main_title {
      font-size: 32px;
      line-height: 34px;
   }
}
#downloads > header {
   margin-bottom: 38px;
}
aside, article {
   display: table-cell;
   vertical-align: top;
}
aside {
   width: 340px;
   min-width: 340px;
   display: none;
}
article {
   padding: 10px 30px;
}
aside > .content {
   margin-top: 24px;
   background: #dde1e4;
   min-height: 300px;
}
section > content {
   margin: 12px 0px;
   display: block;
   height: auto;
}
.cell {
   display: table-cell;
   vertical-align: top;
   padding: 2px 10px 2px 0px;
}
.cell:first-child {
   min-width: 200px;
}
@media (max-width: 480px) {
   article {
      display: block;
   }
   .cell {
      display: block;
   }
   pre {
      width: calc(100vw - 60px);
      overflow-x: auto;
   }
}

pre, code {
   max-width: 900px;
   font-family: Consolas, "Courier New", monospace;
}
p > code {
   padding: 1px 4px;
   background: #d0e1dd;
   border-radius: 2px;
   margin-right: 2px;
}
pre code.hljs {
   padding: 0 1em;
}
nav.footer {
   height: 60px;
   padding-bottom: 20px;
}
@media (max-width: 480px) {
   pre {
      width: calc(100vw - 38px);
      margin-left: -11px;
      border-radius: 6px;
   }
   pre code.hljs {
      padding: 0 0.75em;
   }
   
}
nav > a {
   display: block;
   padding: 7px 12px;
   color: #334a55;
   text-decoration: none;
   border-radius: 4px;
   line-height: 28px;
}
nav > a:hover {
   background: #efefef;
}
nav > a[disabled] {
   visibility: hidden;
}
nav > a:first-child {
   float: left;
}
nav > a:last-child {
   float: right;
}
nav > a:first-child::before {
   display: inline-block;
   content: '<';
   color: transparent;
   background: url('img/prev.png') center center no-repeat;
   width: 16px;
   height: 16px;
   background-size: contain;
   margin-right: 8px;
   position: relative;
   top: 6px;
}
nav > a:first-child::after {
   content: '';
}
nav > a:last-child::before {
   content: '';
}
nav > a:last-child::after {
   display: inline-block;
   content: '>';
   color: transparent;
   background: url('img/next.png') center center no-repeat;
   width: 16px;
   height: 16px;
   background-size: contain;
   margin-left: 8px;
   position: relative;
   top: 6px;
}
@media (max-width: 480px) {
   .footer {
      padding: 0px 10px 18px;
   }
}
@font-face {
   font-family: "PT Serif Caption";
   src: url('fonts/PTSerifCaption.ttf');
}
@font-face {
   font-family: Consolas;
   src: url('fonts/consolas.ttf');
}

.warning {
   background: #f9d5d2;
   border: 1px solid #a55757;
   color: #513e3e;
   padding: 20px 28px;
   max-width: 850px;
}
.warning::before {
   content: 'Важно!';
   margin-right: 17px;
   color: #893d3d;
}
.warning > code {
   background: #faece8;
   box-shadow: 0px 0px 1px 0px rgba(0, 0, 0, 0.23);
}
.info {
   background: #fdf4d6;
   border: 1px solid #928664;
   color: #565148;
   padding: 20px 28px;
   max-width: 850px;
}
.info > code {
   background: #fbf8ef;
   box-shadow: 0px 0px 1px 0px rgba(0, 0, 0, 0.32);
}

#lang {
   position: absolute;
   top: 0;
   right: 265px;
   width: 30px;
   text-align: left;
   padding: 8px;
   font-size: 14px;
   cursor: pointer;
   box-sizing: border-box;
   width: 70px;
   height: 56px;
   z-index: 1;
}
#lang > div:first-child {
   padding: 5px 3px 3px;
   margin-top: -2px;
   line-height: 26px;
   text-align: center;
   border-radius: 3px;
   border: 1px solid transparent;
   display: inline-block;
}
#lang:hover > div:first-child {
   box-shadow: inset 0px 0px 7px 2px rgba(30, 30, 30, 0.25);
   border: 1px solid rgba(130, 130, 130, 0.45);
   background: linear-gradient(to bottom, rgba(130, 134, 136, 0.38) 0%, rgba(130, 136, 136, 0.60) 50%, rgba(132, 132, 132, 0.53) 100%);
   color: #eaeaea;
   text-shadow: 0px 1.3px rgba(47, 42, 48, 0.68), 1px -0.5px rgba(47, 42, 48, 0.18);
}
#lang .list {
   position: relative;
   top: 13px;
   height: 0px;
   background: #ededed;
   border: 1px solid #a6a6a6;
   border-radius: 5px;
   color: #333;
   overflow: hidden;
   border: none;
}
#lang .list > div:hover {
   background: rgba(132, 132, 134, 0.23);
}
#lang:hover > .list {
   width: 80px;
   height: auto;
   border: 1px solid #a6a6a6;
}

</style>
<script type="text/javascript">

var current_index = 0

var links = []

function getContents() {
   var a = document.getElementById('nav').getElementsByTagName('a')
   for (var i = 0; i < a.length; i++) {
      links.push({ url: a[i].href + (i > 0 ? '#downloads' : ''), title: a[i].innerHTML })
   }
   
   try {
      var title = document.getElementById('intro').getElementsByTagName('header')[0].innerHTML
      for (var i = 0; i < links.length; i++) {
         if (links[i].title == title) {
            current_index = i
            break
         }
      }
   } catch(ex) {}
   
   var b = document.getElementById('footer').getElementsByTagName('a')
   
   b[0].href = current_index > 0 ? links[current_index-1].url : ''
   if (current_index > 0) b[0].innerHTML = links[current_index-1].title
   
   b[1].href = current_index < links.length-1 ? links[current_index+1].url : ''
   if (current_index < links.length-1) b[1].innerHTML = links[current_index+1].title
   
   if (current_index == 0) {
      b[0].setAttribute('disabled', '')
   }
   if (current_index == links.length-1) {
      b[1].setAttribute('disabled', '')
   }
}

function initLangs() {
   var list = document.getElementById('lang').lastElementChild
   Array.prototype.forEach.call(list.children, function(el) {
      el.onclick = function() {
         var lang = list.previousElementSibling.innerHTML.trim()
         var str = this.innerHTML.trim()
         if (str == lang) return
         var p = location.href.split('/')
         lang = p[p.length-2]
         if (lang.length != 2) {
            p.splice(p.length-1, 0, 'ru')
         }
         p[p.length-2] = str.toLowerCase()
         location.href = p.join('/')
      }
   })
}

function init() {
   hljs.highlightAll();
   getContents();
   initLangs();
}

</script>
</head>

<body onload="init()">
   <div id="navbar"><div class="logo"></div><a href="index.html" class="title">Autosync</a>
      <div id="lang"><div>RU</div><div class="list"><div>EN</div><div>RU</div></div></div>
      <div class="nav_items" id="nav"><div><a href="index.html">Главная</a></div><div>Функции<div class="list"><div class="item"><a href="contexts.html">Контексты</a></div><div class="item"><a href="templates.html">Шаблоны</a></div><div class="item"><a href="dates.html">Работа с датами</a></div><div class="item"><a href="dynamic-css.html">Динамические стили</a></div><div class="item"><a href="events.html">События</a></div><div class="item"><a href="embeds.html">Включения</a></div><div class="item"><a href="components.html">Компоненты</a></div><div class="item"><a href="hooks.html">Хуки</a></div><div class="item"><a href="pulling-data.html">Обратное связывание</a></div></div></div><div><a href="api.html">API</a></div></div>
   </div>
   <div id="container">
      <aside>
         <div class="content">
         </div>
      </aside>
      <article>
         <section id="top">
            <content style="display: flex; align-items: center">
               <img src="img/logo.png" width="270" style="fit-content-width: 200px; margin-right: 10px" /><div class="main_title">Autosync<div style="font-size: 16px; line-height: 18px; margin-top: 5px">work with data, not with DOM</div></div>
            </content>
         </section>
         <section id="downloads">
            <header>Загрузить</header>
            <content>
               <div><span class="cell"><a href="autosync.js" download>autosync.js</a></span><span class="cell">Обычная версия: IE 9+, Firefox 4.0+, Opera 12.1+, Chrome 5.0+</span></div>
               <div><span class="cell"><a href="autosync-compat.js" download>autosync-compat.js</a></span><span class="cell">Расширенная версия: IE 6+, Firefox 1.0+, Opera 8.0+</span></div>
            </content>
         </section>
         <section id="intro">
            <header>Шаблоны</header>
            <content>
               <p>Шаблоны - это строки, включающие в себя использование данных модели, в которые осуществляется подстановка данных по время обновления DOM. В Autosync есть два типа шаблонов: строковые и функциональные.</p>
            </content>
         </section>
         <section id="string-templates">
            <header>Строковые шаблоны</header>
            <content>
               <p>Строковый шаблон - это строка, в произвольном месте которой встречаются значения для интерполяции. Такими значениями могут быть <code>{$value}</code>, <code>{$value['field']}</code>, <code>{$value[expression]}</code>, где expression - вычисляемое значение JavaScript. Autosync попытается исполнить как выражение всё, что не заключено в одиночные или двойные кавычки.</p>
               <pre><code class="language-html">
&lt;span class="email" asmodel="user.profile_data.email" astemplate="Email: {$value}"&gt;&lt;/span&gt;
               </code></pre>
               <p>Если вам необходимо использовать в тексте строку <code>{$value</code> как есть, добавьте одиночный обратный слеш перед знаком $: <code>{\$value}</code>, <code>{\$value['something']}</code>. При выводе итогового содержимого обратный слеш не будет отображён.</p>
               <p>Вы можете задать шаблон или в атрибуте <code>astemplate</code>, или прямо внутри элемента между открывающим и закрывающим тегом. Во втором случае Autosync будет искать подстроки вида <code>{$value[...][...]}</code>, и только в случае их нахождения содержимое элемента будет обработано как шаблон. В противном случае (при наличии атрибута <code>asmodel</code>) содержимое будет просто заменено данными модели при обновлении.</p>
            </content>
         </section>
         <section id="function-templates">
            <header>Функциональные шаблоны</header>
            <content>
               <p>Функциональный шаблон - это любая пользовательская функция, объявленная в глобальной области видимости, возвращающая требуемое строковое HTML содержимое элемента (innerHTML). Она может принимать произвольное число аргументов, одним из которых может быть специальный аргумент <code>$value</code>, на место которого будет подставлено значение из модели. Для задания такого шаблона используйте префикс <code>func:</code></p>
               <pre><code class="language-html">
&lt;span class="email" asmodel="user.profile_data.email" astemplate="func:setEmail($value)"></span>&gt;
               </code></pre>
               <p class="warning">Функциональный шаблон должен являться полем объекта-контекста, полем вложенного в контекст объекта <code>funcs</code> или глобальным объектом, иначе он не будет найден. При этом порядок Autosync ищет функцию сначала в <code>funcs</code>, потом в контексте, и лишь затем в глобальной области видимости. При наличии нескольких функций с нужным именем в разных местах вызовется первая найденная, остальные будут проигноированы.</p>
               <p class="info">Шаблон вызывается с привязкой к контексту модели (<code>this</code> ссылается на родительский объект). Это даёт вам возможность получить доступ к данным других моделей в том же контейнере. Иногда это может оказаться полезно.</p>
               <p class="info">Вы можете использовать функциональные шаблоны внутри строковых - как с той же моделью, так и с другой.</p>
            </content>
         </section>
         <section id="conditional-rendering">
            <header>Условный вывод</header>
            <content>
               <p>С помощью атрибута <code>asif</code> вы можете вывести часть контента только при выполнении заданного условия. В условии могут фигурировать элементы как поля модели, так и любые доступные JS переменные.</p>
               <pre><code class="language-html">
&lt;!-- Выведет ссылки управления только для сообщений текущего пользователя --&gt;
&lt;div class="links" asif="$value.author_id == user_id"&gt;
    &lt;span class="edit"&gt;Редактировать&lt;/span&gt;&lt;span class="remove"&gt;Удалить&lt;/span&gt;
&lt;/div&gt;
               </code></pre>
            </content>
         </section>
         <section id="rendering-collections">
            <header>Вывод коллекций</header>
            <content>
               <p>Если установить у элемента атрибут <code>aslist</code>, и при этом у модели есть свойство <code>length</code>, являющееся целым числом, то заданный шаблон будет применён к каждому элементу, а итоговый вывод будет объединён в одну строку. Также можно задать диапазон вывода (включая границы) через двоеточие:</p>
               <pre><code class="language-html">
&lt;!-- Выведет e-mail первых трёх пользователей в массиве --&gt;
&lt;div id="emails" class="list" asmodel="users" aslist="0:2"&gt;
    &lt;div class="item" data-id="{$value['id']}"&gt;{$value['email']}&lt;/div&gt;
&lt;/div&gt;
               </code></pre>
               <p class="info">При изменении массива данных методами <code>push</code>, <code>pop</code>, <code>shift</code>, <code>unshift</code>, <code>splice</code> Autosync по возможности выполнит точечные добавления и удаления дочерних блоков вместо того чтобы осуществлять повторный рендеринг всего содержимого.</p>
               <p class="info">Вы можете использовать выражение <code>{$index}</code> для вывода индекса элемента в коллекции. При этом вы можете вывести строку {$index} как обычный текст, добавив обратный слеш перед $: <code>{\$index}</code>.</p>
               <p class="info">Вы можете фильтровать вывод отдельных элементов коллекции с помощью атрибута <code>asif</code>.</p>
            </content>
         </section>
         <section id="placeholders">
            <header>Заполнители</header>
            <content>
               <p>Для моделей, равных null или undefined, а также для пустых массивов, выводимых в режиме коллекции через <code>aslist</code>, вы можете указать контент-заполнитель с помощью атрибута <code>asplaceholder</code>. Значение атрибута - HTML в виде строки либо CSS-селектор элемента, внутреннее содержимое которого будет использовано в качестве заполнителя (в этом случае нужно указать значение в формате <code>($[&nbsp;selector&nbsp;])</code>). Обратите внимание: селектор должен возвращать единственный элемент, поскольку всё, что делает Autosync - передаёт содержимое круглых скобок в функцию <code>document.querySelector</code>, который вернёт первое совпадение.</p>
               <p>Если задан CSS-селектор, но элементов, соответствующих ему, на странице нет, в качестве заполнителя будет использована пустая строка.</p>
               <p>Заполнитель будет помещён внутрь элемента в шаблоне, отвечающего за вывод модели, оказавшейся пустой, а не заменит его: такой подход позволяет получить более корректное отображение без серьёзной модификации стилей.</p>
               <p>Если HTML элемент, для которого указан атрибут <code>asplaceholder</code>, является строковым элементом ввода, то заполнитель будет использован в качестве placeholder, а текущее значение будет очищено.
            </content>
         </section>
         <section id="inner-templates">
            <header>Вложенные шаблоны</header>
            <content>
               <p>Одна из самых мощных возможностей шаблонов - это возможность вкладывать внутрь шаблонов элементы, имеющие свои шаблоны. При этом если у такого элемента не задан атрибут <code>asmodel</code>, будет производиться его поиск по цепочке родительских элементов наверх. В конце концов этот атрибут в любом случае будет найден в элементе, шаблон которого начал обрабатываться первым, если он не будет найден до этого.</p>
               <p>Вот один из примеров такого вложения:</p>
               <pre><code class="language-html">
&lt;div id="task_list" asmodel="data.tasks" aslist&gt;
   &lt;div class="item task_item" asplaceholder="&lt;center&gt;&lt;em&gt;Empty&lt;/em&gt;&lt;/center&gt;" data-id="{$value['id']}"&gt;
      &lt;div class="select select_user" data-param="user_id" data-value="{$value['user_id']}"&gt;
         &lt;div class="user"&gt;
            &lt;div class="avatar" astemplate="func:firstLetters($value['user'])"&gt;AA&lt;/div&gt;
            &lt;div class="name"&gt;{$value['user']}&lt;/div&gt;
         &lt;/div&gt;
         &lt;select asmodel="data.users" aslist&gt;
            &lt;option value="{$value['id']}"&gt;{$value['name']}&lt;/option&gt;
         &lt;/select&gt;
         &lt;/div&gt;
      &lt;div class="title"&gt;{$value['title']}&lt;/div&gt;
      &lt;div class="description"&gt;{$value['description']}&lt;/div&gt;
      /* ... */
   &lt;/div&gt;
&lt;/div&gt;
               </code></pre>
               <p>С точки зрения Autosync в этом коде два вложенных шаблона: один функциональный и использует ту же модель, что родительский шаблон, а второй - строковый, и использует собственную модель <code>data.users</code> (т.к. у него установлен атрибут <code>asmodel</code>). Именно атрибут <code>asmodel</code> в данном случае сообщает Autosync о том, что это вложенный шаблон, а не часть изначального шаблона.</p>
               <p>Вложенные шаблоны вывода коллекций могут быть привязаны как к независимым коллекциям, так и к коллекциям, являющимся полями текущего элемента внешней коллекции. Например, у каждой задачи может быть список этапов, уникальный для неё. В этом случае путь к списку этапов невозможно записать в абсолютном виде, потому что он зависит от индекса задачи в массиве всех задач. На этот случай Autosync предусматривает так называемые относительные пути к моделям. Относительный путь начинается с точки, и соответствует пути к текущему выводимому объекту, конкатенированному с указанной строкой.</p>
               <pre><code class="language-html">
&lt;div id="task_list" asmodel="data.tasks" aslist&gt;
   &lt;div class="item task_item" asplaceholder="&lt;center&gt;&lt;em&gt;Empty&lt;/em&gt;&lt;/center&gt;" data-id="{$value['id']}"&gt;
      /* ... */
      &lt;div class="title"&gt;{$value['title']}&lt;/div&gt;
      &lt;div class="description"&gt;{$value['description']}&lt;/div&gt;
      &lt;ul class="milestones" asmodel=".milestones" aslist&gt;
         &lt;li&gt;{$value['text']}&lt;/li&gt;
      &lt;/ul&gt;
      /* ... */
   &lt;/div&gt;
&lt;/div&gt;
               </code></pre>
            </content>
         </section>
         <section id="compile-templates">
            <header>Компиляция шаблонов</header>
            <content>
               <p>Для наилучшей производительности все шаблоны, независимо от формы задания, компилируются один раз. Это означает, что вы не увидите изменений, просто поменяв значение атрибута <code>astemplate</code> через код. Вам необходимо будет удалить и снова добавить соответствующую модель, чтобы изменения вступили в силу.</p>
            </content>
         </section>
      </article>
      <nav class="footer" id="footer"><a href="">Назад</a><a href="">Далее</a></nav>
   </div>
</body>
</html>
